# Hattz Empire - Claude CLI Committee Container
# 각 위원회 페르소나가 독립 컨테이너로 실행
# Claude CLI는 다중접속 지원

FROM node:20-slim

# 작업 디렉토리
WORKDIR /workspace

# Claude CLI 설치
RUN npm install -g @anthropic-ai/claude-code

# 시스템 유틸
RUN apt-get update && apt-get install -y --no-install-recommends \
    curl \
    git \
    python3 \
    python3-pip \
    && rm -rf /var/lib/apt/lists/*

# 비root 사용자
RUN useradd -m -r claude && chown -R claude:claude /workspace
USER claude

# Claude CLI 설정 디렉토리
RUN mkdir -p /home/claude/.claude

# 환경변수
ENV CLAUDE_CODE_NONINTERACTIVE=1
ENV NODE_ENV=production

# 헬스체크
HEALTHCHECK --interval=30s --timeout=10s --retries=3 \
    CMD claude --version || exit 1

# 기본 명령 (오버라이드 가능)
CMD ["claude", "--help"]
